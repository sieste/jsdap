<html>
    <head>
        <script type="text/javascript" src="json.js"></script>
        <script type="text/javascript" src="jsdap.js"></script>
        <script type="text/javascript">
            function openurl(url, callback) {
                url =  '/proxy/' + encodeURIComponent(url);

                var xml = window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest();
                if (xml) {
                    xml.open("GET", url, true);

                    xml.onreadystatechange = function() {
                        if (xml.readyState == 4) {
                            callback(xml.responseText);
                        }
                    }
                }
                xml.send();
            }

            function loaddds(dds) {
                var ta = document.getElementById('textarea');
                var dataset = new ddsParser(dds, null).parse();

                var url = document.getElementById('url');
                openurl(url.value + '.das', function(das) {
                    dataset = new dasParser(das, dataset).parse();
                    ta.value = toJsonString(dataset);
                });
            }

            function load() {
                var url = document.getElementById('url');
                openurl(url.value + '.dds', loaddds);
                return false;
            }
        </script>
    </head>
    <body>
        <form method="GET" action="#">
            <input type="text" id="url" size="128" value="http://" />
            <input type="button" value="load URL" onclick="load()" />
        </form>
        <textarea id="textarea" style="width: 100%; height: 400px;"></textarea>
    </body>
</html>
